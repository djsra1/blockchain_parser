котировки взяты с 
https://investfunds.ru/

курс руб/usd  с 
cbr.ru

список проверяемых адресов получаю из файла
через API получаю информацию по адресу в json
перекладываю в датафрейм
анализирую на предмет прозрачности транзакции

если транзакция прозрачная 1адрес-n или n-1адрес, собираю конкретику по выходам (n) или входам (n)
иначе просто сообщаю n-m и собираю только то, что напротив адреса 

перевод в USD и RUB реализован в одноименных функциях.
если нет курса на дату - шагау в прошлое, пока не встретится (не более 20 дней), иначе - 0. 

сбрасываю в датафреймы: агрегатный (индексный) файл index.xlsx и файлы с деталями по каждому счету (адрес.xlsx)

ссылки в индексном файле и форматирование реализуется VBA. index.xlsm  


файлы .json для тренировки, т.к. API выкидывает